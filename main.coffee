bind = rx.bind
rx.rxt.importTags()
raw_gists = [
  {
    "url": "https://api.github.com/gists/2e69338e5b025211e00d6267944e9a63",
    "forks_url": "https://api.github.com/gists/2e69338e5b025211e00d6267944e9a63/forks",
    "commits_url": "https://api.github.com/gists/2e69338e5b025211e00d6267944e9a63/commits",
    "id": "2e69338e5b025211e00d6267944e9a63",
    "git_pull_url": "https://gist.github.com/2e69338e5b025211e00d6267944e9a63.git",
    "git_push_url": "https://gist.github.com/2e69338e5b025211e00d6267944e9a63.git",
    "html_url": "https://gist.github.com/2e69338e5b025211e00d6267944e9a63",
    "files": {
      "easy.js": {
        "filename": "easy.js",
        "type": "application/javascript",
        "language": "JavaScript",
        "raw_url": "https://gist.githubusercontent.com/drbelfast/2e69338e5b025211e00d6267944e9a63/raw/dc45b802ab7b2d7bafd7c314083688f7f14214f8/easy.js",
        "size": 530
      }
    },
    "public": true,
    "created_at": "2016-11-08T05:43:42Z",
    "updated_at": "2016-11-08T06:17:09Z",
    "description": "for enhui study",
    "comments": 0,
    "user": null,
    "comments_url": "https://api.github.com/gists/2e69338e5b025211e00d6267944e9a63/comments",
    "owner": {
      "login": "drbelfast",
      "id": 6468832,
      "avatar_url": "https://avatars.githubusercontent.com/u/6468832?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drbelfast",
      "html_url": "https://github.com/drbelfast",
      "followers_url": "https://api.github.com/users/drbelfast/followers",
      "following_url": "https://api.github.com/users/drbelfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/drbelfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drbelfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drbelfast/subscriptions",
      "organizations_url": "https://api.github.com/users/drbelfast/orgs",
      "repos_url": "https://api.github.com/users/drbelfast/repos",
      "events_url": "https://api.github.com/users/drbelfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drbelfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "truncated": false
  },
  {
    "url": "https://api.github.com/gists/4c10d7d049677f40c4a2940050ddb0c9",
    "forks_url": "https://api.github.com/gists/4c10d7d049677f40c4a2940050ddb0c9/forks",
    "commits_url": "https://api.github.com/gists/4c10d7d049677f40c4a2940050ddb0c9/commits",
    "id": "4c10d7d049677f40c4a2940050ddb0c9",
    "git_pull_url": "https://gist.github.com/4c10d7d049677f40c4a2940050ddb0c9.git",
    "git_push_url": "https://gist.github.com/4c10d7d049677f40c4a2940050ddb0c9.git",
    "html_url": "https://gist.github.com/4c10d7d049677f40c4a2940050ddb0c9",
    "files": {
      "preview.css": {
        "filename": "preview.css",
        "type": "text/css",
        "language": "CSS",
        "raw_url": "https://gist.githubusercontent.com/drbelfast/4c10d7d049677f40c4a2940050ddb0c9/raw/86571b80a6f3ee50df8d09c67f79166259e4616c/preview.css",
        "size": 767
      }
    },
    "public": true,
    "created_at": "2016-10-14T05:12:22Z",
    "updated_at": "2016-10-14T05:12:22Z",
    "description": "Add github markdown style to quiver preview mode",
    "comments": 0,
    "user": null,
    "comments_url": "https://api.github.com/gists/4c10d7d049677f40c4a2940050ddb0c9/comments",
    "owner": {
      "login": "drbelfast",
      "id": 6468832,
      "avatar_url": "https://avatars.githubusercontent.com/u/6468832?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drbelfast",
      "html_url": "https://github.com/drbelfast",
      "followers_url": "https://api.github.com/users/drbelfast/followers",
      "following_url": "https://api.github.com/users/drbelfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/drbelfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drbelfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drbelfast/subscriptions",
      "organizations_url": "https://api.github.com/users/drbelfast/orgs",
      "repos_url": "https://api.github.com/users/drbelfast/repos",
      "events_url": "https://api.github.com/users/drbelfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drbelfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "truncated": false
  },
  {
    "url": "https://api.github.com/gists/47a987065947f3338c1a168b8ee473e0",
    "forks_url": "https://api.github.com/gists/47a987065947f3338c1a168b8ee473e0/forks",
    "commits_url": "https://api.github.com/gists/47a987065947f3338c1a168b8ee473e0/commits",
    "id": "47a987065947f3338c1a168b8ee473e0",
    "git_pull_url": "https://gist.github.com/47a987065947f3338c1a168b8ee473e0.git",
    "git_push_url": "https://gist.github.com/47a987065947f3338c1a168b8ee473e0.git",
    "html_url": "https://gist.github.com/47a987065947f3338c1a168b8ee473e0",
    "files": {
      "pubsub.js": {
        "filename": "pubsub.js",
        "type": "application/javascript",
        "language": "JavaScript",
        "raw_url": "https://gist.githubusercontent.com/drbelfast/47a987065947f3338c1a168b8ee473e0/raw/7a43dd56cba04a05d39adb769f22aaa5dffa60fd/pubsub.js",
        "size": 1126
      }
    },
    "public": true,
    "created_at": "2016-07-08T21:12:54Z",
    "updated_at": "2017-01-22T14:44:22Z",
    "description": "",
    "comments": 2,
    "user": null,
    "comments_url": "https://api.github.com/gists/47a987065947f3338c1a168b8ee473e0/comments",
    "owner": {
      "login": "drbelfast",
      "id": 6468832,
      "avatar_url": "https://avatars.githubusercontent.com/u/6468832?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drbelfast",
      "html_url": "https://github.com/drbelfast",
      "followers_url": "https://api.github.com/users/drbelfast/followers",
      "following_url": "https://api.github.com/users/drbelfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/drbelfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drbelfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drbelfast/subscriptions",
      "organizations_url": "https://api.github.com/users/drbelfast/orgs",
      "repos_url": "https://api.github.com/users/drbelfast/repos",
      "events_url": "https://api.github.com/users/drbelfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drbelfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "truncated": false
  },
  {
    "url": "https://api.github.com/gists/48b26fc4fe5cd808ad5b9aba63d11b88",
    "forks_url": "https://api.github.com/gists/48b26fc4fe5cd808ad5b9aba63d11b88/forks",
    "commits_url": "https://api.github.com/gists/48b26fc4fe5cd808ad5b9aba63d11b88/commits",
    "id": "48b26fc4fe5cd808ad5b9aba63d11b88",
    "git_pull_url": "https://gist.github.com/48b26fc4fe5cd808ad5b9aba63d11b88.git",
    "git_push_url": "https://gist.github.com/48b26fc4fe5cd808ad5b9aba63d11b88.git",
    "html_url": "https://gist.github.com/48b26fc4fe5cd808ad5b9aba63d11b88",
    "files": {
      "observer.js": {
        "filename": "observer.js",
        "type": "application/javascript",
        "language": "JavaScript",
        "raw_url": "https://gist.githubusercontent.com/drbelfast/48b26fc4fe5cd808ad5b9aba63d11b88/raw/b59658a766cc4da13d3d30c6b65cf3067df3f7bd/observer.js",
        "size": 1251
      }
    },
    "public": true,
    "created_at": "2016-07-08T21:01:58Z",
    "updated_at": "2017-01-22T14:44:14Z",
    "description": "",
    "comments": 0,
    "user": null,
    "comments_url": "https://api.github.com/gists/48b26fc4fe5cd808ad5b9aba63d11b88/comments",
    "owner": {
      "login": "drbelfast",
      "id": 6468832,
      "avatar_url": "https://avatars.githubusercontent.com/u/6468832?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drbelfast",
      "html_url": "https://github.com/drbelfast",
      "followers_url": "https://api.github.com/users/drbelfast/followers",
      "following_url": "https://api.github.com/users/drbelfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/drbelfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drbelfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drbelfast/subscriptions",
      "organizations_url": "https://api.github.com/users/drbelfast/orgs",
      "repos_url": "https://api.github.com/users/drbelfast/repos",
      "events_url": "https://api.github.com/users/drbelfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drbelfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "truncated": false
  },
  {
    "url": "https://api.github.com/gists/6ed46f64e8c89cc9265c",
    "forks_url": "https://api.github.com/gists/6ed46f64e8c89cc9265c/forks",
    "commits_url": "https://api.github.com/gists/6ed46f64e8c89cc9265c/commits",
    "id": "6ed46f64e8c89cc9265c",
    "git_pull_url": "https://gist.github.com/6ed46f64e8c89cc9265c.git",
    "git_push_url": "https://gist.github.com/6ed46f64e8c89cc9265c.git",
    "html_url": "https://gist.github.com/6ed46f64e8c89cc9265c",
    "files": {
      "getPosition.js": {
        "filename": "getPosition.js",
        "type": "application/javascript",
        "language": "JavaScript",
        "raw_url": "https://gist.githubusercontent.com/drbelfast/6ed46f64e8c89cc9265c/raw/bd881593895d63845f99d934c757e8af429c2d1d/getPosition.js",
        "size": 451
      }
    },
    "public": true,
    "created_at": "2016-03-25T20:17:21Z",
    "updated_at": "2016-03-25T20:17:21Z",
    "description": "get cursor position on web",
    "comments": 0,
    "user": null,
    "comments_url": "https://api.github.com/gists/6ed46f64e8c89cc9265c/comments",
    "owner": {
      "login": "drbelfast",
      "id": 6468832,
      "avatar_url": "https://avatars.githubusercontent.com/u/6468832?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drbelfast",
      "html_url": "https://github.com/drbelfast",
      "followers_url": "https://api.github.com/users/drbelfast/followers",
      "following_url": "https://api.github.com/users/drbelfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/drbelfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drbelfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drbelfast/subscriptions",
      "organizations_url": "https://api.github.com/users/drbelfast/orgs",
      "repos_url": "https://api.github.com/users/drbelfast/repos",
      "events_url": "https://api.github.com/users/drbelfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drbelfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "truncated": false
  }
]
class Gist
  constructor: (@id, @desc, @files) ->

gistsAll = rx.array raw_gists.map (g) ->
  new Gist(g.id, g.description, g.files)

currentGist = rx.cell(gistsAll.at(0))
$('body').append(
  div {class: 'container'}, [
    div {class: 'sidebar'}, [
      ul {}, gistsAll.map (g) ->
        li {class: "#{if g == currentGist.get() then 'selected'}", click: -> currentGist.set(g)}, g.desc
    ]
    div {class: 'preview'}, [
      h3 {}, bind -> currentGist.get().desc
      div {}, bind ->
        for fileName, file of currentGist.get().files
          do(fileName, file) ->
            # need separate fileContent for each file
            fileContent = rx.cell('')
            $.ajax({
              url: file.raw_url,
              success: (data) ->
                fileContent.set(data)
            })
            div {}, [
              pre {}, fileName
              code {}, bind -> fileContent.get()
            ]
    ]
  ]
)